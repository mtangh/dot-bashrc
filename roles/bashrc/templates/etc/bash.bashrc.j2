# bash.bashrc
# System-wide .bashrc file for interactive bash(1) shells.
# {{ ansible_managed }}

# Bash ?
[ -z "$BASH" ] &&
  return 0
# Interactive shell ?
[ -z "$PS1" ] &&
  return 0

# Block recursive call !
[[ "${BASH_SOURCE[@]}" \
  =~ .*\ ${BASH_SOURCE}(\ .*|\ *)$ ]] &&
  return 127

# Treat unset variables as an error when
# performing parameterr expansion.
set -u

# bash resource configs default
bashrcdir="{{ bashrc_bashrcdir_path|d('/etc/bash.bashrc.d',true) }}"
bashlocal="/usr/local/etc/${bashrcdir##*/}"

# Platform
. "${bashrcdir}/__platform.sh" 1>/dev/null 2>&1 || {
  declare -r osvendor=__UNKNOWN__
  declare -r ostype=__UNKNOWN__
  declare -r machine=__UNKNOWN__
}

# User Groups
usergroups="$(id -Gn 2>/dev/null)"

# Prompt setting (default)
PS1='\u@\h \W\$ '

# Load to the 'bash.bashrc.d' scripts
for bashrcsh in \
"${bashrcdir}"/[0-9][0-9]*.sh{,.${os},.${osvendor},.${machine}}
do
  set +u; [ ! -x "$bashrcsh" ] || . "$bashrcsh"; set -u
done

# cleanup
unset bashrcdir bashlocal usergroups bashrcsh

# unset 'u'
set +u

# *eof*
